openapi: 3.0.3
info:
  title: LaborGuard Community Service API
  description: Community Management Service for LaborGuard
  version: 1.0.0
servers:
  - url: http://localhost:3002
tags:
  - name: Profiles
    description: User profile management
  - name: Posts
    description: Community posts
  - name: Comments
    description: Post comments
  - name: Statuses
    description: User statuses (stories)
  - name: Reports
    description: Content reports

paths:
  /api/profiles:
    post:
      tags: [Profiles]
      summary: Create or update a user profile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                name:
                  type: string
                role:
                  type: string
      responses:
        "200":
          description: Profile created/updated
        "500":
          description: Server error

  /api/profiles/{userId}:
    get:
      tags: [Profiles]
      summary: Get a user profile
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User profile data
        "404":
          description: Profile not found

  /api/profiles/{userId}/bookmarks:
    get:
      tags: [Profiles]
      summary: Get user bookmarks
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of bookmarked posts

  /api/profiles/follow:
    post:
      tags: [Profiles]
      summary: Follow a user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [followerId, followingId]
              properties:
                followerId:
                  type: string
                followingId:
                  type: string
      responses:
        "200":
          description: Followed successfully

  /api/profiles/unfollow:
    post:
      tags: [Profiles]
      summary: Unfollow a user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [followerId, followingId]
              properties:
                followerId:
                  type: string
                followingId:
                  type: string
      responses:
        "200":
          description: Unfollowed successfully

  /api/profiles/bookmark:
    post:
      tags: [Profiles]
      summary: Toggle bookmark on a post
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, postId]
              properties:
                userId:
                  type: string
                postId:
                  type: string
      responses:
        "200":
          description: Bookmark toggled

  /api/posts:
    post:
      tags: [Posts]
      summary: Create a new post
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                userId:
                  type: string
                content:
                  type: string
                hashtags:
                  type: string
                media:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        "201":
          description: Post created
        "400":
          description: Validation error

  /api/posts/feed/{userId}:
    get:
      tags: [Posts]
      summary: Get user feed
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of feed posts

  /api/posts/trending:
    get:
      tags: [Posts]
      summary: Get trending feed
      responses:
        "200":
          description: List of trending posts

  /api/posts/hashtag/{tag}:
    get:
      tags: [Posts]
      summary: Search posts by hashtag
      parameters:
        - in: path
          name: tag
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Posts matching the hashtag

  /api/posts/{postId}:
    get:
      tags: [Posts]
      summary: Get a single post by ID
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Post details
        "404":
          description: Post not found
    put:
      tags: [Posts]
      summary: Update a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                content:
                  type: string
                media:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        "200":
          description: Post updated
    delete:
      tags: [Posts]
      summary: Delete a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Post deleted

  /api/posts/{postId}/like:
    post:
      tags: [Posts]
      summary: Like or unlike a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        "200":
          description: Post liked/unliked

  /api/posts/{postId}/share:
    post:
      tags: [Posts]
      summary: Share a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        "200":
          description: Post shared

  /api/posts/{postId}/poll:
    post:
      tags: [Posts]
      summary: Vote on a poll
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, optionIndex]
              properties:
                userId:
                  type: string
                optionIndex:
                  type: integer
      responses:
        "200":
          description: Vote recorded

  /api/posts/{postId}/report:
    post:
      tags: [Posts]
      summary: Report a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, reason]
              properties:
                userId:
                  type: string
                reason:
                  type: string
      responses:
        "200":
          description: Post reported

  /api/comments/{postId}:
    post:
      tags: [Comments]
      summary: Add a comment to a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, content]
              properties:
                userId:
                  type: string
                content:
                  type: string
      responses:
        "201":
          description: Comment added
    get:
      tags: [Comments]
      summary: Get comments for a post
      parameters:
        - in: path
          name: postId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of comments

  /api/comments/{commentId}:
    delete:
      tags: [Comments]
      summary: Delete a comment
      parameters:
        - in: path
          name: commentId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Comment deleted

  /api/comments/{commentId}/report:
    post:
      tags: [Comments]
      summary: Report a comment
      parameters:
        - in: path
          name: commentId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, reason]
              properties:
                userId:
                  type: string
                reason:
                  type: string
      responses:
        "200":
          description: Comment reported

  /api/statuses:
    post:
      tags: [Statuses]
      summary: Create a status (story)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                userId:
                  type: string
                content:
                  type: string
                media:
                  type: string
                  format: binary
      responses:
        "201":
          description: Status created

  /api/statuses/feed/{userId}:
    get:
      tags: [Statuses]
      summary: Get statuses feed
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of statuses

  /api/statuses/{statusId}:
    delete:
      tags: [Statuses]
      summary: Delete a status
      parameters:
        - in: path
          name: statusId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Status deleted

  /api/reports:
    post:
      tags: [Reports]
      summary: Create a report
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reporterId:
                  type: string
                targetType:
                  type: string
                  enum: [post, comment]
                targetId:
                  type: string
                reason:
                  type: string
      responses:
        "201":
          description: Report created
    get:
      tags: [Reports]
      summary: Get all reports
      responses:
        "200":
          description: List of reports

  /api/reports/{reportId}/status:
    put:
      tags: [Reports]
      summary: Update report status
      parameters:
        - in: path
          name: reportId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
      responses:
        "200":
          description: Report status updated
